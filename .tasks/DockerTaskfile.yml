# https://taskfile.dev

version: '2'

vars:
  GREETING: Hello, World!

tasks:
  default:
    cmds:
      - echo "{{.GREETING}}"
    silent: false
  
  create-container:
    desc: Create local mysql container for kafka
    cmds:
      - cmd: docker ps -a | grep some-kafka || docker create --name some-kafka -p 2181:2181 -p 9092:9092 --env ADVERTISED_HOST=localhost --env ADVERTISED_PORT=9092 spotify/kafka

  start:
    deps: [create-container]
    desc: Run the local kafka contianer
    cmds:
      - cmd: docker ps | grep some-kafka || docker start some-kafka

  create-es-container:
    desc: Create local elasticsearch container 
    cmds:
      - cmd: docker ps -a | grep some-elastic || docker create --name some-elastic -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:6.7.0

  start-es:
    deps: [create-es-container]
    desc: Run the local elasticsearch contianer
    cmds:
      - cmd: docker ps | grep some-elastic || docker start some-elastic